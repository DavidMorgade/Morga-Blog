---
import PostCard from "./PostCard.astro";
import PostCardBig from "./PostCardBig.astro";
import { type GetPostsRequest, type Post } from "../../types/postRequest";
import Badge from "./Badge.astro";

const URL = "http://localhost:1337"; // URL to the API

const data = await fetch(
  `${URL}/api/posts?populate=featured_image&sort=id:desc`,
);

const jsonData: GetPostsRequest = await data.json();

const posts = jsonData.data;
---

<ul class="mt-8">
  <PostCardBig post={posts[0]} />
  {
    posts.map((post: Post, index: number) => {
      if (index === 0) return null;
      if (index === 3)
        return (
          <PostCardBig post={post}>
            <Badge
              color="text-violet-700"
              bgColor="text-violet-300"
              badgeText="design"
            />
          </PostCardBig>
        );

      if (index > 4) return null;
      return (
        <div class="sm:flex sm:items-center sm:justify-start">
          <PostCard post={post} />
        </div>
      );
    })
  }
</ul>
