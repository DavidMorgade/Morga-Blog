---
import BaseHead from '../../components/BaseHead.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../../consts';
import FormattedDate from '../../components/FormattedDate.astro';

const URL = 'http://localhost:1337'; // URL to the API

type Post = {
    attributes: {
        title: string;
        content: string;
        reading_time: number;
        slug: string;
        createdAt:Date; 
        updatedAt: Date;
        publishedAt: Date;
    }

}

const data = await fetch(`${URL}/api/posts`);

const jsonData = await data.json();

const posts: Post[] = jsonData.data;

console.log(posts);

---

<!doctype html>
    <html lang="en">
        <head>
            <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION}>
        </head>
        <body>
            <Header />
            <main>
                <section>
                    <ul class="grid grid-cols-3 content-center">
                        {
                            posts.map((post) => (
                                <li>
                                    <a href={`/blog/${post.attributes.slug}/`}>
                                        <!-- <img width={720} height={360} src={post.data.heroImage} alt="" /> -->
                                        <h4 class="title">{post.attributes.title}</h4>
                                        <p class="date">
                                           {post.attributes.createdAt}
                                       </p>
                                    </a>
                                </li>
                            ))
                        }
                    </ul>
                </section>
            </main>
            <Footer />
        </body>
    </html>
